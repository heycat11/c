#include<stdio.h> 
int phi, M,d,C,n,e; 
void encrypt()
{
int i; 
C = 1;
for(i=0;i<e;i++)
{
C=C*M%n;
C = C%n;
}
printf("\nEncrypted keyword : %d",C); 
}

void decrypt() {
int i;
M = 1; 
for(i=0;i<d;i++) 
{
M=M*C%n;
M = M%n;
}
printf("\nDecrypted keyword : %d",M);
}

int main()
{
int i, p,q,rem;
printf("\nEnter Two Distinct Prime Numbers: "); 
scanf("%d%d",&p,&q);
n = p*q;
phi=(p-1)*(q-1);
printf("\nPhi= %d",phi);
printf("\nEnter e coprime with Phi(1<e<%d): ",phi); 
scanf("%d",&e);
if((e<phi)&&(e>1))
{
for(i=2;i<phi;i++)
{
if(e%i==0&&phi%i==0) {
printf("\nInvalid value of e\n");
return 0;
 }
}
d =0;
do {
d++;
rem = (d*e)%phi; }
while(rem!=1);
} 
else {
printf("\nInvalid value of e\n");
return 0;
}
printf("\n\tPublic Key\t:{%d,%d}",e,n); 
printf("\n\tPrivate Key\t:{%d,%d}",d,n); 
printf("\n\nEnter The Plain Text(0<PT<%d)\t: ",n); 
scanf("%d",&M);
if(M<n)
{ encrypt(); 
decrypt();
 }
else
{
printf("\nInvalid Plain text\n");
return 0;
}
}
